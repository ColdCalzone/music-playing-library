<xml xmlns="https://developers.google.com/blockly/xml"><block type="pxt-on-start" id="W3p:mr7]t}Wq5^5L08B%" x="-395" y="2"><statement name="HANDLER"><block type="typescript_statement" id="]s6)eYCOrJpfuJ@jlY]l" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="namespace song {" line1="    //% block=&quot;play song $song at tempo $tempo&quot;" line2="    export function song_to_melody(song: string, tempo: number) {" line3="        let mode = 0" line4="        let offset = 0" line5="        let pos = 0" line6="        let newlines = 0" line7="        let line_length = 0" line8="" line9="        let letter: string;" line10="    " line11="        let melodies : string[] = []" line12="        let letters : string[] = []" line13="        //  ???? wtheck am i working with here???" line14="        while (song.indexOf(&quot;|&quot;) != -1) {" line15="            song = song.replace(&quot;|&quot;, &quot;&quot;)" line16="        }" line17="        while (song.indexOf(&quot; &quot;) != -1) {" line18="            song = song.replace(&quot; &quot;, &quot;&quot;)" line19="        }" line20="        line_length = song.indexOf(&quot;\n&quot;)" line21="        for (let i of song) {" line22="            if (i == &quot;\n&quot;) {" line23="                newlines += 1" line24="                if (newlines == 2) {" line25="                    pos += line_length" line26="                    newlines = 0" line27="                }" line28="            " line29="                offset = 0" line30="                continue" line31="            }" line32="        " line33="            if (i == &quot;&quot; + (&quot;&quot; + parseInt(i))) {" line34="                mode = parseInt(i)" line35="                if (newlines == 1) {" line36="                    newlines = 0" line37="                    offset = 0" line38="                }" line39="            " line40="            } else {" line41="                //  It seems like some completely normal methods are missing??? have to do this utter crap." line42="                letter = i" line43="                if (letter != &quot;-&quot;) {" line44="                    if (i.toLowerCase() != i) {" line45="                        letter = &quot;&quot; + letter + &quot;#&quot;" line46="                    }" line47="                " line48="                    letter = &quot;&quot; + letter + &quot;&quot; + (&quot;&quot; + (&quot;&quot; + mode))" line49="                }" line50="            " line51="                if (letters[pos + offset] == null || letters[pos + offset] == &quot;-&quot;) {" line52="                    letters[pos + offset] = letter" line53="                }" line54="            " line55="                offset += 1" line56="            }" line57="        " line58="        }" line59="" line60="        let melody = &quot;&quot;" line61="        let note_count = 0" line62="        note_count = 1" line63="        for (let x of letters) {" line64="            melody = &quot;&quot; + melody + x + &quot; &quot;" line65="            note_count += 1" line66="            if (note_count == 8) {" line67="                note_count = 0" line68="                melodies.push(melody)" line69="                melody = &quot;&quot;" line70="            }" line71="        " line72="        }" line73="        for (let lets_go of melodies) {" line74="            music.playMelody(lets_go, tempo)" line75="        }" line76="    }" line77="}" numlines="78"></mutation></block></statement></block><block type="pxt-on-start" id="}A(jjUX)6[b:OsYjI]j*" disabled="true" x="0" y="0"/></xml>